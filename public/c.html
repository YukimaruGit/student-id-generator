<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <!-- åŸºæœ¬æƒ…å ± -->
  <title>æ”¾èª²å¾Œã‚¯ãƒ­ãƒ‹ã‚¯ãƒ«å­¦ç”Ÿè¨¼</title>
  <meta name="description" content="æ”¾èª²å¾Œã‚¯ãƒ­ãƒ‹ã‚¯ãƒ«å­¦ç”Ÿè¨¼ãŒå®Œæˆã—ã¾ã—ãŸï¼è¨ºæ–­ã‚²ãƒ¼ãƒ ã§è‡ªåˆ†ã ã‘ã®å­¦æ ¡ç”Ÿæ´»ã‚’è¦‹ã¤ã‘ã‚ˆã†ã€‚">
  
  <!-- SNSãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç”¨ã®é™çš„ãƒ¡ã‚¿ã‚¿ã‚°ï¼ˆã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼å‘ã‘ï¼‰ -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="æ”¾èª²å¾Œã‚¯ãƒ­ãƒ‹ã‚¯ãƒ«å­¦ç”Ÿè¨¼ãŒå®Œæˆã—ã¾ã—ãŸï¼">
  <meta property="og:description" content="ã‚ãªãŸã ã‘ã®å­¦ç”Ÿè¨¼ãŒå®Œæˆã—ã¾ã—ãŸï¼è¨ºæ–­ã‚²ãƒ¼ãƒ ã§è‡ªåˆ†ã ã‘ã®å­¦æ ¡ç”Ÿæ´»ã‚’è¦‹ã¤ã‘ã‚ˆã†ã€‚">
  <meta property="og:site_name" content="æ”¾èª²å¾Œã‚¯ãƒ­ãƒ‹ã‚¯ãƒ«">
  <meta property="og:locale" content="ja_JP">
  <meta property="og:url" content="https://student-id.app/c">
  
  <!-- Twitter Cardç”¨ã®é™çš„ãƒ¡ã‚¿ã‚¿ã‚° -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="æ”¾èª²å¾Œã‚¯ãƒ­ãƒ‹ã‚¯ãƒ«å­¦ç”Ÿè¨¼ãŒå®Œæˆã—ã¾ã—ãŸï¼">
  <meta name="twitter:description" content="ã‚ãªãŸã ã‘ã®å­¦ç”Ÿè¨¼ãŒå®Œæˆã—ã¾ã—ãŸï¼è¨ºæ–­ã‚²ãƒ¼ãƒ ã§è‡ªåˆ†ã ã‘ã®å­¦æ ¡ç”Ÿæ´»ã‚’è¦‹ã¤ã‘ã‚ˆã†ã€‚">
  <meta name="twitter:site" content="@student_id_app">
  
  <!-- ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ç”»åƒï¼ˆå¾Œã§JavaScriptã§ç½®æ›ï¼‰ -->
  <meta property="og:image" content="https://via.placeholder.com/1200x630/667eea/ffffff?text=å­¦ç”Ÿè¨¼">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta property="og:image:type" content="image/png">
  <meta name="twitter:image" content="https://via.placeholder.com/1200x630/667eea/ffffff?text=å­¦ç”Ÿè¨¼">
  
  <!-- å‹•çš„OGPã‚¿ã‚°è¨­å®šï¼ˆå³åº§å®Ÿè¡Œï¼‰ -->
  <script>
    // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å³åº§ã«è§£æã—ã¦OGPã‚¿ã‚°ã‚’æ›´æ–°
    (function() {
      const params = new URLSearchParams(window.location.search);
      const imageParam = params.get('x') || params.get('i');
      const nameParam = params.get('y') || params.get('n');
      
      // Base64ãƒ‡ã‚³ãƒ¼ãƒ‰é–¢æ•°
      function safeDecode(str) {
        if (!str) return str;
        try {
          str = str.replace(/-/g, '+').replace(/_/g, '/');
          while (str.length % 4) str += '=';
          return decodeURIComponent(atob(str));
        } catch (e) {
          return str;
        }
      }
      
      const imageUrl = safeDecode(imageParam);
      const name = safeDecode(nameParam);
      
      if (imageUrl) {
        // OGPç”»åƒã‚’æ›´æ–°
        const ogImage = document.querySelector('meta[property="og:image"]');
        if (ogImage) ogImage.setAttribute('content', imageUrl);
        
        const twitterImage = document.querySelector('meta[name="twitter:image"]');
        if (twitterImage) twitterImage.setAttribute('content', imageUrl);
      }
      
      if (name) {
        // ã‚¿ã‚¤ãƒˆãƒ«ã¨èª¬æ˜ã‚’æ›´æ–°
        const title = `${name}ã®å­¦ç”Ÿè¨¼ - æ”¾èª²å¾Œã‚¯ãƒ­ãƒ‹ã‚¯ãƒ«`;
        const description = `${name}ã®å­¦ç”Ÿè¨¼ãŒå®Œæˆã—ã¾ã—ãŸï¼ã‚ãªãŸã‚‚è¨ºæ–­ã‚²ãƒ¼ãƒ ã§è‡ªåˆ†ã ã‘ã®å­¦æ ¡ç”Ÿæ´»ã‚’è¦‹ã¤ã‘ã‚ˆã†ã€‚`;
        
        document.title = title;
        
        const ogTitle = document.querySelector('meta[property="og:title"]');
        if (ogTitle) ogTitle.setAttribute('content', title);
        
        const ogDesc = document.querySelector('meta[property="og:description"]');
        if (ogDesc) ogDesc.setAttribute('content', description);
        
        const twitterTitle = document.querySelector('meta[name="twitter:title"]');
        if (twitterTitle) twitterTitle.setAttribute('content', title);
        
        const twitterDesc = document.querySelector('meta[name="twitter:description"]');
        if (twitterDesc) twitterDesc.setAttribute('content', description);
      }
    })();
  </script>

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Hiragino Sans', 'Yu Gothic UI', sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
    }

    .container {
      background: white;
      border-radius: 20px;
      padding: 40px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      text-align: center;
      max-width: 500px;
      width: 100%;
    }

    .logo {
      font-size: 1.5rem;
      font-weight: bold;
      color: #667eea;
      margin-bottom: 20px;
    }

    h1 {
      color: #333;
      margin-bottom: 30px;
      font-size: 1.8rem;
    }

    .card-preview {
      margin: 30px 0;
      cursor: pointer;
      transition: transform 0.3s ease;
      position: relative;
    }

    .card-preview:hover {
      transform: scale(1.02);
    }

    .card-preview img {
      max-width: 100%;
      height: auto;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }

    .description {
      color: #666;
      margin: 30px 0;
      line-height: 1.6;
    }

    .buttons {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
    }

    .btn {
      flex: 1;
      padding: 15px 25px;
      border-radius: 10px;
      text-decoration: none;
      font-weight: bold;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      min-width: 120px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
    }

    .btn-secondary {
      background: #f8f9fa;
      color: #666;
      border: 2px solid #e9ecef;
    }

    .btn-secondary:hover {
      background: #e9ecef;
      transform: translateY(-2px);
    }

    @media (max-width: 480px) {
      .container {
        padding: 30px 20px;
      }
      
      .buttons {
        flex-direction: column;
      }
      
      .btn {
        width: 100%;
      }
    }

    .error {
      padding: 40px;
      background: #f8f9fa;
      color: #666;
      border-radius: 15px;
    }

    .loading {
      color: #667eea;
      font-size: 1.1rem;
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="logo">ğŸ“ æ”¾èª²å¾Œã‚¯ãƒ­ãƒ‹ã‚¯ãƒ«</div>
    
    <h1 id="title">å­¦ç”Ÿè¨¼ãŒå®Œæˆã—ã¾ã—ãŸï¼</h1>
    
    <div class="card-preview" id="cardContainer">
      <div id="loadingMessage" class="loading">
        <i class="fas fa-spinner fa-spin"></i>
        èª­ã¿è¾¼ã¿ä¸­...
      </div>
      <img id="cardImage" src="" alt="å­¦ç”Ÿè¨¼" style="display: none;">
      <div id="errorMessage" class="error" style="display: none;">
        <i class="fas fa-exclamation-triangle"></i>
        <p>ç”»åƒã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸ</p>
      </div>
    </div>
    
    <div class="description">
      ã‚ãªãŸã ã‘ã®å­¦ç”Ÿè¨¼ãŒå®Œæˆã—ã¾ã—ãŸï¼<br>
      <strong>ç”»åƒã‚’ã‚¿ãƒƒãƒ—ã—ã¦è¨ºæ–­ã‚²ãƒ¼ãƒ ã‚’ä½“é¨“ã—ã‚ˆã†</strong>
    </div>
    
    <div class="buttons">
      <a href="https://preview.studio.site/live/1Va6D4lMO7/student-id" class="btn btn-primary">
        <i class="fas fa-dice"></i>
        è¨ºæ–­ã‚²ãƒ¼ãƒ 
      </a>
      <a href="https://preview.studio.site/live/1Va6D4lMO7/student-id/generator.html" class="btn btn-secondary">
        <i class="fas fa-id-card"></i>
        å­¦ç”Ÿè¨¼ä½œæˆ
      </a>
    </div>
  </div>

  <script>
    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è§£æã¨è¡¨ç¤ºï¼ˆå¼·åŒ–ç‰ˆï¼‰
    const urlParams = new URLSearchParams(window.location.search);
    const imageParam = urlParams.get('x') || urlParams.get('i');
    const nameParam = urlParams.get('y') || urlParams.get('n');
    
    // Base64ãƒ‡ã‚³ãƒ¼ãƒ‰é–¢æ•°
    function safeDecode(str) {
      if (!str) return str;
      try {
        str = str.replace(/-/g, '+').replace(/_/g, '/');
        while (str.length % 4) str += '=';
        return decodeURIComponent(atob(str));
      } catch (e) {
        return str;
      }
    }
    
    const imageUrl = safeDecode(imageParam);
    const name = safeDecode(nameParam);
    
    console.log('ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿è§£æçµæœ:', { imageUrl, name });
    
    // ç”»åƒè¡¨ç¤º
    if (imageUrl) {
      const img = document.getElementById('cardImage');
      const loading = document.getElementById('loadingMessage');
      const error = document.getElementById('errorMessage');
      
      img.onload = function() {
        loading.style.display = 'none';
        img.style.display = 'block';
        error.style.display = 'none';
        console.log('âœ… ç”»åƒèª­ã¿è¾¼ã¿æˆåŠŸ');
      };
      
      img.onerror = function() {
        loading.style.display = 'none';
        img.style.display = 'none';
        error.style.display = 'block';
        console.error('âŒ ç”»åƒèª­ã¿è¾¼ã¿å¤±æ•—');
      };
      
      img.src = imageUrl;
      
      // ç”»åƒã‚¯ãƒªãƒƒã‚¯ã§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
      document.getElementById('cardContainer').onclick = function() {
        window.open('https://preview.studio.site/live/1Va6D4lMO7/student-id', '_blank');
      };
    } else {
      document.getElementById('loadingMessage').style.display = 'none';
      document.getElementById('errorMessage').style.display = 'block';
      console.warn('âš ï¸ ç”»åƒURLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
    }
    
    // ã‚¿ã‚¤ãƒˆãƒ«æ›´æ–°
    if (name) {
      document.getElementById('title').textContent = `${name}ã®å­¦ç”Ÿè¨¼ãŒå®Œæˆã—ã¾ã—ãŸï¼`;
      console.log('âœ… ã‚¿ã‚¤ãƒˆãƒ«æ›´æ–°:', name);
    }
  </script>
</body>
</html> 