<!doctype html><meta charset="utf-8"><meta name="viewport" content="width=device-width">
<title>Share</title>
<script>
(async () => {
  const p = new URLSearchParams(location.search);
  const text = p.get('text') || '';
  const img  = p.get('img'); // ä¾‹: /ogp/v{version}/{public_id}.jpg

  let files = [];
  if (img) {
    try {
      const r = await fetch(img, { cache: 'no-store' });
      const b = await r.blob();
      files = [new File([b], 'student-id.jpg', { type: b.type || 'image/jpeg' })];
    } catch {}
  }

  try {
    if (navigator.share) {
      await navigator.share(files.length ? { text, files } : { text });
      window.close(); return;
    }
  } catch {}

  location.replace('https://x.com/intent/post?text=' + encodeURIComponent(text));
})();
</script>
