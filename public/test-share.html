  <div class="container">
    <h1>ğŸ”— å…±æœ‰URLãƒ†ã‚¹ãƒˆ - Botåˆ¤å®šå¯¾ç­–ãƒ»URLçŸ­ç¸®å¯¾å¿œ</h1>
    
    <div class="test-section">
      <h2>ğŸ“± å…±æœ‰URLã®ç”Ÿæˆãƒ†ã‚¹ãƒˆï¼ˆçŸ­ç¸®ç‰ˆï¼‰</h2>
      <p>Botåˆ¤å®šå¯¾ç­–ã¨URLçŸ­ç¸®ã‚’çµ„ã¿è¾¼ã‚“ã å…±æœ‰URLã‚’ç”Ÿæˆã—ã€Xãƒ»Discordã§ã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã‚’ãƒ†ã‚¹ãƒˆã§ãã¾ã™ï¼š</p>
      <ul>
        <li><strong>Public ID:</strong> test_student_card</li>
        <li><strong>Version:</strong> 1</li>
        <li><strong>Image URL:</strong> https://res.cloudinary.com/di5xqlddy/image/upload/v1/as_chronicle/student_card/test.jpg</li>
        <li><strong>çŸ­ç¸®ç‰ˆ:</strong> ãƒ‡ãƒ¼ã‚¿ã‚’åœ§ç¸®ã—ã¦URLé•·ã‚’æœ€å°åŒ–</li>
        <li><strong>Botåˆ¤å®šå¯¾ç­–:</strong> è‡ªç„¶ãªHTMLæ§‹é€ ã¨ãƒ¡ã‚¿ã‚¿ã‚°</li>
      </ul>
      
      <button class="btn btn-success" onclick="generateTestUrl()">ğŸš€ ãƒ†ã‚¹ãƒˆç”¨å…±æœ‰URLã‚’ç”Ÿæˆ</button>
      
      <div id="testUrlResult" style="display: none;">
        <h3>âœ¨ ç”Ÿæˆã•ã‚ŒãŸURL:</h3>
        <div id="testUrl" class="url-display"></div>
        <div class="btn-group">
          <button class="btn" onclick="copyTestUrl()">ğŸ“‹ URLã‚’ã‚³ãƒ”ãƒ¼</button>
          <button class="btn btn-warning" onclick="testUrl()">ğŸ§ª URLã‚’ãƒ†ã‚¹ãƒˆ</button>
          <button class="btn btn-success" onclick="analyzeUrl()">ğŸ” URLåˆ†æ</button>
        </div>
        
        <div id="urlAnalysis" style="display: none; margin-top: 1rem;">
          <h4>ğŸ“Š URLåˆ†æçµæœ</h4>
          <div class="debug-info">
            <strong>URLé•·:</strong> <span id="urlLength"></span> æ–‡å­—<br>
            <strong>çŸ­ç¸®ç‡:</strong> <span id="shorteningRatio"></span><br>
            <strong>ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰æ–¹å¼:</strong> Base64URLï¼ˆæœ€é©åŒ–æ¸ˆã¿ï¼‰<br>
            <strong>Botåˆ¤å®šå¯¾ç­–:</strong> è‡ªç„¶ãªHTMLæ§‹é€  + é…å»¶ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ
          </div>
        </div>
      </div>
    </div>
    
    <div class="test-section">
      <h2>ğŸ¤– Botåˆ¤å®šå¯¾ç­–ã®è©³ç´°</h2>
      <p>ä»¥ä¸‹ã®å¯¾ç­–ã«ã‚ˆã‚Šã€Botåˆ¤å®šã‚’å›é¿ã—ã€ç¢ºå®Ÿã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã•ã‚Œã‚‹ã‚ˆã†ã«ãªã£ã¦ã„ã¾ã™ï¼š</p>
      
      <div class="platform-test">
        <div class="platform-card">
          <h4>ğŸ”„ è‡ªç„¶ãªãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ</h4>
          <ul style="text-align: left; font-size: 0.9rem;">
            <li>2ç§’ã®è‡ªç„¶ãªé…å»¶</li>
            <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³å¯¾å¿œ</li>
            <li>ãƒ¡ã‚¿ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯</li>
          </ul>
        </div>
        
        <div class="platform-card">
          <h4>ğŸ—ï¸ HTMLæ§‹é€ </h4>
          <ul style="text-align: left; font-size: 0.9rem;">
            <li>å®Œå…¨ãªHTML5æ§‹é€ </li>
            <li>è‡ªç„¶ãªã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°</li>
            <li>ç”»åƒã®ç›´æ¥è¡¨ç¤º</li>
          </ul>
        </div>
      </div>
      
      <div class="preview-info">
        <h4>ğŸ’¡ Botåˆ¤å®šå›é¿ã®ãƒã‚¤ãƒ³ãƒˆ</h4>
        <ul>
          <li><strong>å³åº§ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå›é¿:</strong> è‡ªç„¶ãªé…å»¶ã§Botåˆ¤å®šã‚’å›é¿</li>
          <li><strong>å®Œå…¨ãªHTML:</strong> ä¸å®Œå…¨ãªHTMLã«ã‚ˆã‚‹Botåˆ¤å®šã‚’é˜²æ­¢</li>
          <li><strong>ç”»åƒç›´æ¥è¡¨ç¤º:</strong> ã‚¯ãƒ­ãƒ¼ãƒ©ãƒ¼ãŒç¢ºå®Ÿã«ç”»åƒã‚’å–å¾—</li>
          <li><strong>è‡ªç„¶ãªJavaScript:</strong> æ©Ÿæ¢°çš„ãªå‹•ä½œã‚’é¿ã‘ã‚‹</li>
        </ul>
      </div>
    </div>
    
    <div class="test-section">
      <h2>ğŸ” ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ†ã‚¹ãƒˆï¼ˆXãƒ»Discordï¼‰</h2>
      <p>ç”Ÿæˆã•ã‚ŒãŸå…±æœ‰URLã‚’ä»¥ä¸‹ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ï¼š</p>
      
      <div class="platform-test">
        <div class="platform-card">
          <div class="platform-icon">ğŸ¦</div>
          <h3>X (Twitter)</h3>
          <p>1. ç”Ÿæˆã•ã‚ŒãŸURLã‚’ã‚³ãƒ”ãƒ¼</p>
          <p>2. Xã§æŠ•ç¨¿ï¼ˆç”»åƒä»˜ããƒ„ã‚¤ãƒ¼ãƒˆï¼‰</p>
          <p>3. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã‚’ç¢ºèª</p>
          <div id="x-status">
            <span class="status-indicator status-pending"></span>
            ãƒ†ã‚¹ãƒˆå¾…ã¡
          </div>
        </div>
        
        <div class="platform-card">
          <div class="platform-icon">ğŸ®</div>
          <h3>Discord</h3>
          <p>1. ç”Ÿæˆã•ã‚ŒãŸURLã‚’ã‚³ãƒ”ãƒ¼</p>
          <p>2. Discordã§æŠ•ç¨¿</p>
          <p>3. ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã‚’ç¢ºèª</p>
          <div id="discord-status">
            <span class="status-indicator status-pending"></span>
            ãƒ†ã‚¹ãƒˆå¾…ã¡
          </div>
        </div>
      </div>
      
      <div class="preview-info">
        <h4>ğŸ’¡ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼è¡¨ç¤ºã®ãƒã‚¤ãƒ³ãƒˆ</h4>
        <ul>
          <li><strong>ç”»åƒ:</strong> ä½œæˆã•ã‚ŒãŸå­¦ç”Ÿè¨¼ã®ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã‚‹</li>
          <li><strong>ã‚¿ã‚¤ãƒˆãƒ«:</strong> "æ”¾èª²å¾Œã‚¯ãƒ­ãƒ‹ã‚¯ãƒ« å­¦ç”Ÿè¨¼"</li>
          <li><strong>èª¬æ˜:</strong> "ã‚ãªãŸãŒä½œã£ãŸå­¦ç”Ÿè¨¼ã‚’ãƒã‚§ãƒƒã‚¯ï¼"</li>
          <li><strong>ã‚µã‚¤ã‚º:</strong> 1200Ã—630pxï¼ˆæœ€é©åŒ–æ¸ˆã¿ï¼‰</li>
          <li><strong>Botåˆ¤å®šå¯¾ç­–:</strong> è‡ªç„¶ãªHTML + é…å»¶ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ</li>
        </ul>
      </div>
    </div>
    
    <div class="test-section">
      <h2>âš™ï¸ å…±æœ‰URLã®å‹•ä½œç¢ºèª</h2>
      <p>ç”Ÿæˆã•ã‚ŒãŸå…±æœ‰URLã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®æµã‚Œã§å‹•ä½œã—ã¾ã™ï¼š</p>
      <ol>
        <li>å…±æœ‰URLï¼ˆ<code>/s/{slug}</code>ï¼‰ã«ã‚¢ã‚¯ã‚»ã‚¹</li>
        <li>ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ã§OGPãƒ¡ã‚¿ã‚¿ã‚°ã‚’å‹•çš„ç”Ÿæˆ</li>
        <li><strong>Botåˆ¤å®šå¯¾ç­–:</strong> è‡ªç„¶ãªHTMLã§ç”»åƒã‚’è¡¨ç¤º</li>
        <li>2ç§’å¾Œã«æŒ‡å®šã•ã‚ŒãŸHPã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ</li>
        <li>HPå´ã§å…±æœ‰ã•ã‚ŒãŸå­¦ç”Ÿè¨¼ç”»åƒã‚’è¡¨ç¤º</li>
      </ol>
      
      <div class="debug-info">
        <strong>ãƒ‡ãƒãƒƒã‚°æƒ…å ±:</strong><br>
        - OGPç”»åƒ: å‹•çš„ã«ç”Ÿæˆã•ã‚ŒãŸå­¦ç”Ÿè¨¼ç”»åƒ<br>
        - URLçŸ­ç¸®: ãƒ‡ãƒ¼ã‚¿åœ§ç¸®ã«ã‚ˆã‚‹URLé•·æœ€é©åŒ–<br>
        - Botåˆ¤å®šå¯¾ç­–: è‡ªç„¶ãªHTML + é…å»¶ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ<br>
        - ã‚­ãƒ£ãƒƒã‚·ãƒ¥: é©åˆ‡ã«åˆ¶å¾¡æ¸ˆã¿
      </div>
    </div>
    
    <div class="test-section">
      <h2>ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœã®è¨˜éŒ²</h2>
      <p>å„ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã®ãƒ†ã‚¹ãƒˆçµæœã‚’è¨˜éŒ²ã—ã¦ãã ã•ã„ï¼š</p>
      
      <div class="platform-test">
        <div class="platform-card">
          <h4>X (Twitter) ãƒ†ã‚¹ãƒˆçµæœ</h4>
          <button class="btn btn-success" onclick="markTestResult('x', 'success')">âœ… æˆåŠŸ</button>
          <button class="btn btn-warning" onclick="markTestResult('x', 'partial')">âš ï¸ éƒ¨åˆ†çš„</button>
          <button class="btn" onclick="markTestResult('x', 'failed')">âŒ å¤±æ•—</button>
        </div>
        
        <div class="platform-card">
          <h4>Discord ãƒ†ã‚¹ãƒˆçµæœ</h4>
          <button class="btn btn-success" onclick="markTestResult('discord', 'success')">âœ… æˆåŠŸ</button>
          <button class="btn btn-warning" onclick="markTestResult('discord', 'partial')">âš ï¸ éƒ¨åˆ†çš„</button>
          <button class="btn" onclick="markTestResult('discord', 'failed')">âŒ å¤±æ•—</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    function generateTestUrl() {
      const payload = {
        p: 'test_student_card',
        v: 1,
        i: 'https://res.cloudinary.com/di5xqlddy/image/upload/v1/as_chronicle/student_card/test.jpg'
      };
      
      // çŸ­ç¸®ç‰ˆURLç”Ÿæˆï¼ˆå®Ÿéš›ã®å®Ÿè£…ã¨åŒã˜ï¼‰
      const shortData = {
        p: payload.p.substring(0, 8), // æœ€åˆã®8æ–‡å­—ã®ã¿ä½¿ç”¨
        v: payload.v,
        i: payload.i.split('/').pop() // ãƒ•ã‚¡ã‚¤ãƒ«åã®ã¿ä½¿ç”¨
      };
      
      const jsonStr = JSON.stringify(shortData);
      const bin = Array.from(new TextEncoder().encode(jsonStr), b => String.fromCharCode(b)).join('');
      const slug = btoa(bin).replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'');
      
      // è¨­å®šã•ã‚ŒãŸãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ä½¿ç”¨ã—ã¦URLã‚’ç”Ÿæˆ
      const currentDomain = document.getElementById('currentDomain').textContent;
      const shareUrl = `${currentDomain}/s/${slug}`;
      
      document.getElementById('testUrl').textContent = shareUrl;
      document.getElementById('testUrlResult').style.display = 'block';
      
      // ãƒ†ã‚¹ãƒˆçµæœã‚’ãƒªã‚»ãƒƒãƒˆ
      resetTestResults();
      
      // URLåˆ†æã‚’è¡¨ç¤º
      analyzeUrl();
    }
    
    function copyTestUrl() {
      const url = document.getElementById('testUrl').textContent;
      navigator.clipboard.writeText(url).then(() => {
        alert('âœ… URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\n\nXã‚„Discordã§æŠ•ç¨¿ã—ã¦ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚\n\nBotåˆ¤å®šå¯¾ç­–ã«ã‚ˆã‚Šã€ã‚ˆã‚Šç¢ºå®Ÿã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚');
      }).catch(() => {
        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯
        const textArea = document.createElement('textarea');
        textArea.value = url;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        alert('âœ… URLã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼\n\nXã‚„Discordã§æŠ•ç¨¿ã—ã¦ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’ãƒ†ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚\n\nBotåˆ¤å®šå¯¾ç­–ã«ã‚ˆã‚Šã€ã‚ˆã‚Šç¢ºå®Ÿã«ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¯ãšã§ã™ã€‚');
      });
    }
    
    function testUrl() {
      const url = document.getElementById('testUrl').textContent;
      window.open(url, '_blank');
    }
    
    function analyzeUrl() {
      const url = document.getElementById('testUrl').textContent;
      const originalLength = 200; // å…ƒã®URLã®æ¨å®šé•·
      const currentLength = url.length;
      const shorteningRatio = Math.round((1 - currentLength / originalLength) * 100);
      const currentDomain = document.getElementById('currentDomain').textContent;
      
      document.getElementById('urlLength').textContent = currentLength;
      document.getElementById('shorteningRatio').textContent = `${shorteningRatio}%çŸ­ç¸®`;
      document.getElementById('generatedDomain').textContent = currentDomain;
      document.getElementById('urlAnalysis').style.display = 'block';
    }
    
    function markTestResult(platform, result) {
      const statusElement = document.getElementById(`${platform}-status`);
      const indicator = statusElement.querySelector('.status-indicator');
      
      // ã‚¯ãƒ©ã‚¹ã‚’æ›´æ–°
      indicator.className = 'status-indicator';
      switch(result) {
        case 'success':
          indicator.classList.add('status-success');
          statusElement.innerHTML = '<span class="status-indicator status-success"></span>âœ… ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æˆåŠŸ';
          break;
        case 'partial':
          indicator.classList.add('status-warning');
          statusElement.innerHTML = '<span class="status-indicator status-warning"></span>âš ï¸ éƒ¨åˆ†çš„ã«è¡¨ç¤º';
          break;
        case 'failed':
          indicator.classList.add('status-error');
          statusElement.innerHTML = '<span class="status-indicator status-error"></span>âŒ ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼å¤±æ•—';
          break;
      }
    }
    
    function resetTestResults() {
      document.getElementById('x-status').innerHTML = '<span class="status-indicator status-pending"></span>ãƒ†ã‚¹ãƒˆå¾…ã¡';
      document.getElementById('discord-status').innerHTML = '<span class="status-indicator status-pending"></span>ãƒ†ã‚¹ãƒˆå¾…ã¡';
    }
    
    function updateDomain() {
      const newDomain = document.getElementById('domainInput').value;
      if (newDomain) {
        document.getElementById('currentDomain').textContent = newDomain;
        alert('ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒæ›´æ–°ã•ã‚Œã¾ã—ãŸï¼');
      } else {
        alert('ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚');
      }
    }
  </script>
