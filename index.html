<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ÊîæË™≤Âæå„ÇØ„É≠„Éã„ÇØ„É´ ‚Äï Ë®∫Êñ≠„Ç≤„Éº„É†</title>
  <link rel="icon" type="image/png" href="assets/img/crest.png">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&family=Noto+Serif+JP:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="assets/css/style.css">
  <style>
    /* Ë®∫Êñ≠„Ç≤„Éº„É†Â∞ÇÁî®„Çπ„Çø„Ç§„É´ */
    .diagnosis-container {
      max-width: 800px;
      margin: 2rem auto;
      padding: 1rem;
    }

    .question-card {
      background: rgba(248, 246, 240, 0.9);
      border-radius: 12px;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      transform: perspective(1000px) rotateY(-10deg);
      transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
    }

    .question-card.active {
      transform: perspective(1000px) rotateY(0deg);
    }

    .question-card.answered {
      transform: perspective(1000px) rotateY(10deg);
      opacity: 0.7;
    }

    .question-card.fade-out {
      opacity: 0;
      transform: translateX(-20px);
      transition: all 0.4s ease-in;
    }

    .question-card.fade-in {
      opacity: 1;
      transform: translateX(0);
      transition: all 0.4s ease-out;
    }

    .question-title {
      font-size: 1.5rem;
      font-weight: 650;
      color: #666;
      margin-bottom: 1.5rem;
      text-align: center;
    }

    .question-text {
      font-size: 1.2rem;
      color: #444;
      margin-bottom: 2rem;
      line-height: 1.6;
    }

    .answer-options {
      display: grid;
      gap: 1rem;
    }

    .answer-option {
      padding: 1rem 1.5rem;
      background: white;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      color: #666;
      font-weight: 500;
    }

    .answer-option:hover {
      background: #f8f9fa;
      border-color: #dda0dd;
      color: #444;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(221, 160, 221, 0.2);
    }

    .question-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 2rem;
      gap: 1rem;
    }

    .back-btn {
      background: #a8a8a8;
      color: white;
      border: none;
      padding: 0.75rem 1.5rem;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 500;
    }

    .back-btn:hover {
      background: #969696;
      transform: translateY(-1px);
    }

    .back-btn:disabled {
      background: #e0e0e0;
      color: #999;
      cursor: not-allowed;
      transform: none;
    }

    .question-number {
      color: #666;
      font-weight: 500;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e0e0e0;
      border-radius: 4px;
      margin-bottom: 2rem;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #dda0dd, #b0c4de);
      border-radius: 4px;
      transition: width 0.6s cubic-bezier(0.25, 1, 0.5, 1);
      width: 0%;
    }

    .result-container {
      text-align: center;
      display: none;
    }

    .result-card {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.95), rgba(248, 249, 250, 0.9));
      border-radius: 16px;
      padding: 3rem 2.5rem;
      margin-bottom: 2rem;
      box-shadow: 
        0 8px 32px rgba(221, 160, 221, 0.15),
        0 4px 16px rgba(0, 0, 0, 0.08);
      border: 2px solid rgba(221, 160, 221, 0.2);
      max-width: 650px;
      margin-left: auto;
      margin-right: auto;
      position: relative;
      overflow: hidden;
    }

    .result-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #dda0dd, #b0c4de, #98d7a5);
    }

    .result-title {
      font-size: 2.2rem;
      font-weight: 700;
      background: linear-gradient(135deg, #dda0dd, #b0c4de);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 0.75rem;
      text-align: center;
      text-shadow: 0 2px 4px rgba(221, 160, 221, 0.3);
      letter-spacing: -0.02em;
    }

    .result-subtitle {
      font-size: 1.1rem;
      color: #787878;
      margin-bottom: 2.5rem;
      font-weight: 500;
      text-align: center;
      opacity: 0.9;
    }

    .result-details {
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.9), rgba(248, 248, 255, 0.8));
      border-radius: 12px;
      padding: 2rem;
      margin-bottom: 2.5rem;
      border: 2px solid rgba(221, 160, 221, 0.1);
      box-shadow: 
        0 4px 15px rgba(221, 160, 221, 0.08),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
    }

    .result-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1rem;
      padding: 0.75rem 0;
      background: none;
      border: none;
      border-bottom: 1px solid rgba(221, 160, 221, 0.2);
      border-radius: 0;
      transition: all 0.3s ease;
      box-shadow: none;
    }

    .result-item:hover {
      border-bottom-color: rgba(221, 160, 221, 0.4);
    }

    .result-item:last-child {
      margin-bottom: 0;
      border-bottom: none;
    }

    .result-label {
      color: #787878;
      font-weight: 600;
      font-size: 0.95rem;
      display: flex;
      align-items: center;
      gap: 0.4rem;
    }

    .result-value {
      color: #4a4a4a;
      font-weight: 700;
      font-size: 1rem;
      text-align: right;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    }

    .preview-msg {
      font-size: 1.4rem;
      color: #444;
      font-weight: 600;
      margin-bottom: 2.5rem;
      padding: 1.5rem 2rem;
      background: linear-gradient(135deg, rgba(248, 249, 250, 0.9), rgba(255, 255, 255, 0.8));
      border-radius: 12px;
      border-left: 5px solid #dda0dd;
      box-shadow: 
        0 4px 15px rgba(221, 160, 221, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.8);
      line-height: 1.6;
      backdrop-filter: blur(5px);
      transition: all 0.3s ease;
    }

    .preview-msg:hover {
      transform: translateY(-1px);
      box-shadow: 
        0 6px 20px rgba(221, 160, 221, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.9);
    }

    .narrative-text {
      font-size: 1.1rem;
      color: #555;
      line-height: 1.8;
      margin-bottom: 2rem;
      padding: 1.5rem;
      background: rgba(248, 246, 240, 0.8);
      border-radius: 12px;
      border: 2px solid #e0e0e0;
      white-space: pre-line;
      font-family: 'Noto Sans JP', sans-serif;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    .episode-msg {
      font-size: 1.1rem;
      color: #555;
      line-height: 1.7;
      margin-bottom: 2.5rem;
      padding: 1.5rem 2rem;
      background: linear-gradient(135deg, rgba(255, 248, 220, 0.9), rgba(255, 250, 235, 0.8));
      border-radius: 12px;
      border: 2px solid rgba(240, 208, 160, 0.3);
      border-left: 5px solid #f0d0a0;
      font-family: 'Noto Sans JP', sans-serif;
      box-shadow: 
        0 4px 12px rgba(240, 208, 160, 0.15),
        inset 0 1px 0 rgba(255, 255, 255, 0.6);
      text-align: center;
      font-style: italic;
      font-weight: 500;
      backdrop-filter: blur(5px);
      transition: all 0.3s ease;
    }

    .episode-msg:hover {
      transform: translateY(-1px);
      box-shadow: 
        0 6px 18px rgba(240, 208, 160, 0.2),
        inset 0 1px 0 rgba(255, 255, 255, 0.7);
    }

    .unified-result-card {
      background: rgba(248, 249, 250, 0.5);
      border-radius: 8px;
      padding: 1.5rem;
      border: 1px solid rgba(221, 160, 221, 0.15);
      box-shadow: none;
      backdrop-filter: none;
    }

    .unified-result-card .preview-msg {
      margin-bottom: 1.5rem;
      background: none;
      border: none;
      border-left: 4px solid #dda0dd;
      border-radius: 0;
      box-shadow: none;
      padding: 1rem 1.5rem 1rem 2rem;
      font-size: 1.1rem;
      color: #4a4a4a;
      font-weight: 600;
      line-height: 1.6;
      text-align: center;
      letter-spacing: 0.01em;
    }

    .unified-result-card .result-details {
      margin-bottom: 1.25rem;
      background: none;
      border: none;
      border-radius: 0;
      box-shadow: none;
      padding: 0;
    }

    .episode-section {
      margin-top: 1.5rem;
      padding: 1.25rem 0 0;
      background: none;
      border: none;
      border-top: 2px solid rgba(152, 215, 165, 0.3);
      border-radius: 0;
      box-shadow: none;
      position: relative;
    }

    .episode-title {
      font-size: 1rem;
      font-weight: 700;
      color: #4a4a4a;
      margin-bottom: 0.75rem;
      text-align: center;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      text-shadow: none;
    }

    .unified-result-card .episode-msg {
      background: none;
      border: none;
      border-radius: 0;
      box-shadow: none;
      padding: 0;
      margin: 0;
      font-style: italic;
      font-weight: 500;
      font-size: 0.95rem;
      color: #787878;
      line-height: 1.5;
      text-align: center;
      letter-spacing: 0.01em;
    }

    .to-generator-btn {
      background: linear-gradient(135deg, #dda0dd, #b0c4de);
      color: white;
      border: 2px solid rgba(221, 160, 221, 0.3);
      padding: 1rem 2rem;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      box-shadow: 0 4px 12px rgba(221, 160, 221, 0.3);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
      letter-spacing: 0.02em;
    }

    .to-generator-btn:hover {
      background: linear-gradient(135deg, #e0a8e0, #b8ccde);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(221, 160, 221, 0.4);
      border-color: rgba(221, 160, 221, 0.5);
    }

    .restart-btn {
      background: linear-gradient(135deg, #98d7a5, #b0c4de);
      color: white;
      border: 2px solid rgba(152, 215, 165, 0.3);
      padding: 1rem 2rem;
      font-size: 1.1rem;
      font-weight: 600;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      box-shadow: 0 4px 12px rgba(152, 215, 165, 0.3);
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
      letter-spacing: 0.02em;
    }

    .restart-btn:hover {
      background: linear-gradient(135deg, #a0daa8, #b8ccde);
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(152, 215, 165, 0.4);
      border-color: rgba(152, 215, 165, 0.5);
    }

    .button-container {
      display: flex;
      gap: 1.5rem;
      justify-content: center;
      flex-wrap: wrap;
      margin-top: 2rem;
      padding-top: 1.25rem;
      border-top: 2px solid rgba(221, 160, 221, 0.1);
    }



    @media (max-width: 768px) {
      .diagnosis-container {
        padding: 1rem;
        margin: 1rem auto;
      }

      .question-card {
        padding: 1.5rem;
      }

      .question-title {
        font-size: 1.2rem;
      }

      .question-text {
        font-size: 1rem;
      }

      .result-card {
        padding: 2rem 1.5rem;
        margin: 1rem;
      }

      .result-title {
        font-size: 1.8rem;
      }

      .result-subtitle {
        font-size: 1rem;
      }

      .unified-result-card {
        padding: 1.25rem;
      }

      .unified-result-card .preview-msg {
        font-size: 1rem;
        padding: 0.875rem 1.25rem 0.875rem 1.5rem;
        margin-bottom: 1.25rem;
      }

      .result-item {
        padding: 0.625rem 0;
        margin-bottom: 0.875rem;
      }

      .result-label {
        font-size: 0.9rem;
      }

      .result-value {
        font-size: 0.95rem;
      }

      .episode-section {
        padding: 1rem 0 0;
        margin-top: 1.25rem;
      }

      .episode-title {
        font-size: 0.95rem;
        margin-bottom: 0.625rem;
      }

      .unified-result-card .episode-msg {
        font-size: 0.9rem;
        padding: 0;
      }

      .button-container {
        margin-top: 1.75rem;
        gap: 1rem;
        padding-top: 1rem;
      }

      .to-generator-btn,
      .restart-btn {
        width: 100%;
        padding: 0.875rem 1.5rem;
        font-size: 1rem;
        margin-bottom: 0.5rem;
      }

      .question-controls {
        flex-direction: column;
        align-items: center;
        gap: 0.5rem;
      }

      .back-btn {
        width: 100%;
        justify-content: center;
        padding: 1rem;
      }

      .question-number {
        font-size: 0.9rem;
      }

      .narrative-text {
        font-size: 1rem;
        padding: 1rem;
        line-height: 1.6;
      }

      .episode-msg {
        font-size: 0.9rem;
        padding: 0.8rem 1rem;
        line-height: 1.5;
      }

      .unified-result-card {
        padding: 1rem;
      }

      .episode-title {
        font-size: 0.95rem;
      }

      .unified-result-card .preview-msg {
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <!-- „Éò„ÉÉ„ÉÄ„Éº„Çø„Ç§„Éà„É´ÂâäÈô§Ê∏à„Åø -->
  </header>

  <div class="diagnosis-container">
    <!-- ÈÄ≤Êçó„Éê„Éº -->
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>

    <!-- Ë≥™ÂïèË°®Á§∫„Ç®„É™„Ç¢ -->
    <div id="questionContainer">
      <!-- Ë≥™Âïè„Åå„Åì„Åì„Å´ÂãïÁöÑ„Å´Ë°®Á§∫„Åï„Çå„Çã -->
    </div>

    <!-- ÁµêÊûúË°®Á§∫„Ç®„É™„Ç¢ -->
    <div class="result-container" id="resultContainer">
      <div class="result-card">
        <div class="result-title">üéì Ë®∫Êñ≠ÁµêÊûúÁô∫Ë°®ÔºÅ</div>
        <div class="result-subtitle">„ÅÇ„Å™„Åü„ÅÆÂ≠¶Ê†°ÁîüÊ¥ª„ÅØ...</div>
        
        <div class="unified-result-card">
          <div class="preview-msg" id="previewMsg">
            <!-- „É©„É≥„ÉÄ„É†„ÉÜ„É≥„Éó„É¨„Éº„Éà„É°„ÉÉ„Çª„Éº„Ç∏ -->
          </div>

          <div class="result-details">
            <div class="result-item">
              <span class="result-label">üìö Â≠¶Áßë/„Ç≥„Éº„Çπ</span>
              <span class="result-value" id="resultCourse">-</span>
            </div>
            <div class="result-item">
              <span class="result-label">üé≠ ÈÉ®Ê¥ªÂãï</span>
              <span class="result-value" id="resultClub">-</span>
            </div>
          </div>

          <div class="episode-section">
            <div class="episode-title">üçÉ „Å≤„Å®„Åè„Å°„Ç®„Éî„ÇΩ„Éº„Éâ</div>
            <div class="episode-msg" id="episodeMsg">
              <!-- ÂÄãÊÄß„Ç®„Éî„ÇΩ„Éº„Éâ„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
            </div>
          </div>
        </div>

        <div class="button-container">
          <button class="to-generator-btn" id="toGeneratorBtn">
            <i class="fas fa-id-card"></i>
            Â≠¶ÁîüË®º„Çí‰ΩúÊàê„Åô„Çã
          </button>
          <button class="restart-btn" id="restartBtn">
            <i class="fas fa-redo"></i>
            Ë®∫Êñ≠„Çí„ÇÑ„ÇäÁõ¥„Åô
          </button>
        </div>
      </div>
    </div>
  </div>



  <footer>
    <p>&copy; 2024 ÊîæË™≤Âæå„ÇØ„É≠„Éã„ÇØ„É´ Ë®∫Êñ≠„Ç≤„Éº„É†</p>
  </footer>

  <script>
    // Ë≥™Âïè„Éó„Éº„É´ÔºàÂÖ®22ÂïèÔºè„É©„É≥„ÉÄ„É†10ÂïèÂá∫È°åÔºâ
    const questionPool = [
      {
        q: 'Êúù„ÅÆÊîØÂ∫¶„ÄÅ„Å©„Çì„Å™ÊÑü„ÅòÔºü',
        choices: [
          { text:'„Åé„Çä„Åé„Çä„Åæ„ÅßÂØù„Å¶„Çã', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:4 } },
          { text:'ÊîØÂ∫¶„ÅØÂâçÊó•„Å´ÂÆåÁíß', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'„Å™„Çì„Å®„Å™„Åè„ÅßOK', scores:{ course:null, club:'ÁæéË°ì', vibe:3 } },
          { text:'ÊØéÊúù„Éâ„Çø„Éê„Çø„Åó„Å¶„Çã', scores:{ course:null, club:'„ÉÄ„É≥„ÇπÈÉ®', vibe:5 } }
        ]
      },
      {
        q: 'ÊéàÊ•≠‰∏≠„Å´„Çà„Åè„ÅÇ„Çã„Åì„Å®„ÅØÔºü',
        choices: [
          { text:'„Å§„ÅÑËêΩÊõ∏„Åç„Åó„Å¶„Åó„Åæ„ÅÜ', scores:{ course:'ÁæéË°ì„Ç≥„Éº„Çπ', club:null, vibe:3 } },
          { text:'„Éé„Éº„Éà„Çí„Åç„Çå„ÅÑ„Å´„Åæ„Å®„ÇÅ„Çã', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'Â§¢„ÅÆ‰∏≠', scores:{ course:null, club:'Âõ≥Êõ∏', vibe:2 } },
          { text:'ÂèãÈÅî„Å´„Åì„Å£„Åù„Çä„É°„É¢Ê∏°„Åô', scores:{ course:null, club:'ÊñáËä∏', vibe:4 } }
        ]
      },
      {
        q: '„ÅäÊòº‰ºë„Åø„ÅÆÈÅé„Åî„ÅóÊñπ„ÅØÔºü',
        choices: [
          { text:'ÂèãÈÅî„Å®„ÉØ„Ç§„ÉØ„Ç§„ÅîÈ£Ø', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:4 } },
          { text:'Âõ≥Êõ∏ÂÆ§„Åß„ÅÆ„Çì„Å≥„ÇäË™≠Êõ∏', scores:{ course:null, club:'Âõ≥Êõ∏', vibe:2 } },
          { text:'Ê†°Â∫≠„ÅßÈÅä„Å∂', scores:{ course:null, club:'Èô∏‰∏äÈÉ®', vibe:3 } },
          { text:'Ë≥ºË≤∑„ÉÄ„ÉÉ„Ç∑„É•', scores:{ course:null, club:'„Éê„Çπ„Ç±„ÉÉ„Éà„Éú„Éº„É´ÈÉ®', vibe:5 } }
        ]
      },
      {
        q: '‰ΩìËÇ≤„ÅÆÊôÇÈñì„Å®„ÅÑ„Åà„Å∞Ôºü',
        choices: [
          { text:'ÂÖ®Âäõ„ÅßÂãù„Å°„Å´„ÅÑ„ÅèÔºÅ', scores:{ course:null, club:'„ÉÜ„Éã„ÇπÈÉ®', vibe:2 } },
          { text:'„Åæ„ÅÇ„Åæ„ÅÇÊ•Ω„Åó„ÇÄÊ¥æ', scores:{ course:null, club:'„Éê„É¨„Éº„Éú„Éº„É´ÈÉ®', vibe:3 } },
          { text:'Ë¶ãÂ≠¶„Åó„Åü„ÅÑ‚Ä¶‚Ä¶', scores:{ course:null, club:'ÊñáËä∏', vibe:1 } },
          { text:'‰ΩìËÇ≤Á•≠„Å†„ÅëÊú¨Ê∞óÂá∫„Åô', scores:{ course:null, club:'„ÉÄ„É≥„ÇπÈÉ®', vibe:4 } }
        ]
      },
      {
        q: 'ÊîæË™≤Âæå„ÅÆ‰∫àÂÆö„ÅØÔºü',
        choices: [
          { text:'ÈÉ®Ê¥ª„Å´ÂÖ®ÂäõÔºÅ', scores:{ course:null, club:'ÂêπÂ•èÊ•ΩÈÉ®', vibe:2 } },
          { text:'ÂèãÈÅî„Å®ÂØÑ„ÇäÈÅì', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:4 } },
          { text:'Âç≥Â∏∞ÂÆÖ', scores:{ course:null, club:'Â∏∞ÂÆÖ', vibe:3 } },
          { text:'Â≠¶Ê†°„Å´ÊÆã„Å£„Å¶Ëá™‰∏ªÁ∑¥„ÇÑËá™Áøí', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } }
        ]
      },
      {
        q: '„ÉÜ„Çπ„ÉàÊúüÈñì‰∏≠„ÄÅ„ÅÇ„Å™„Åü„ÅØ‚Ä¶Ôºü',
        choices: [
          { text:'Ë®àÁîªÁöÑ„Å´„Ç≥„ÉÑ„Ç≥„ÉÑ', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'‰∏ÄÂ§úÊº¨„Åë', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:5 } },
          { text:'ÂãâÂº∑‰ºö„ÇíÈñãÂÇ¨', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:3 } },
          { text:'„Éé„É™„Å®Âã¢„ÅÑ', scores:{ course:null, club:'„ÉÄ„É≥„ÇπÈÉ®', vibe:4 } }
        ]
      },
      {
        q: 'ÊúùÁôªÊ†°„Åó„ÅüÊôÇ„Å´„Åæ„ÅöÊÄù„ÅÜ„Åì„Å®„ÅØÔºü',
        choices: [
          { text:'‰ªäÊó•„ÅÆ‰∫àÂÆö„ÉÅ„Çß„ÉÉ„ÇØ', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'Áú†„Åô„Åé„Çã', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:4 } },
          { text:'ÂèãÈÅî„Å®Ë©±„Åó„Åü„ÅÑ', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:3 } },
          { text:'Â∏∞„Çä„Åü„ÅÑ', scores:{ course:null, club:'Â∏∞ÂÆÖ', vibe:5 } }
        ]
      },
      {
        q: 'ÊñáÂåñÁ•≠„Åß„ÇÑ„Å£„Å¶„Åø„Åü„ÅÑ„Åì„Å®„ÅØÔºü',
        choices: [
          { text:'ÊºîÂäá„ÇÑ„ÉÄ„É≥„Çπ„ÅÆ„Çπ„ÉÜ„Éº„Ç∏', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:3 } },
          { text:'Ê®°Êì¨Â∫ó„ÇÑÂ±ãÂè∞ÈÅãÂñ∂', scores:{ course:null, club:'„Éê„Çπ„Ç±„ÉÉ„Éà„Éú„Éº„É´ÈÉ®', vibe:4 } },
          { text:'Â±ïÁ§∫„ÇÑÂà∂‰ΩúÁ≥ª„ÅÆÂá∫„ÅóÁâ©', scores:{ course:'ÁæéË°ì„Ç≥„Éº„Çπ', club:null, vibe:2 } },
          { text:'„ÅäÂåñ„ÅëÂ±ãÊï∑„ÇÑËÑ±Âá∫„Ç≤„Éº„É†', scores:{ course:null, club:'„Éõ„É©„ÉºÂ∏ÉÊïôÈÉ®', vibe:5 } }
        ]
      },
      {
        q: 'Âøò„ÇåÁâ©„Åó„ÅüÊôÇ„Å©„ÅÜ„Åô„ÇãÔºü',
        choices: [
          { text:'Ê≠£Áõ¥„Å´Ë®Ä„Å£„Å¶Ë¨ù„Çã', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'Ë™∞„Åã„Å´ÂÄü„Çä„Çã', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:3 } },
          { text:'„Åù„ÇÇ„Åù„ÇÇÊ∞ó„Å•„Åã„Å™„ÅÑ', scores:{ course:null, club:'ÁæéË°ì', vibe:4 } },
          { text:'„Å™„Çì„Å®„ÅãË™§È≠îÂåñ„Åô', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:5 } }
        ]
      },
      {
        q: '„ÉÜ„Çπ„ÉàËøîÂç¥„ÅÆÊó•„ÅÆÊ∞óÊåÅ„Å°„ÅØÔºü',
        choices: [
          { text:'Ëá™‰ø°„ÅÇ„Çä', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:2 } },
          { text:'„Å®„Å´„Åã„ÅèÁ•à„Çã', scores:{ course:null, club:'ÊñáËä∏', vibe:3 } },
          { text:'Âë®„Çä„ÅÆÁÇπÊï∞„ÅåÊ∞ó„Å´„Å™„Çã', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:4 } },
          { text:'„Åì„Çå‰Ωï„ÅÆÊïôÁßë„Å†„Å£„ÅëÔºü', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:5 } }
        ]
      },
      {
        q: 'Êúù„ÅÆ„Éõ„Éº„É†„É´„Éº„É†„ÄÅ„ÅÇ„Å™„Åü„ÅÆÂßø„ÅØÔºü',
        choices: [
          { text:'„Éê„ÉÉ„ÉÅ„É™ÂÖÉÊ∞ó„Å´Ëøî‰∫ã„Åô„Çã', scores:{ course:null, club:'Èô∏‰∏äÈÉ®', vibe:2 } },
          { text:'Â§¢„ÅÆ‰∏≠', scores:{ course:null, club:'ÁæéË°ì', vibe:3 } },
          { text:'Èö£„ÅÆÂèãÈÅî„Å®Â∞èÂ£∞„ÅßË©±„Åó„Å¶„Çã', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:4 } },
          { text:'ÈÅÖÂàª„ÇÆ„É™„ÇÆ„É™„ÅßÈßÜ„ÅëËæº„ÇÄ', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:5 } }
        ]
      },
      {
        q: 'Âªä‰∏ã„Åß„Åô„ÇåÈÅï„ÅÜÂÖàÁîü„Å´„ÅØÔºü',
        choices: [
          { text:'„Åç„Å°„Çì„Å®Êå®Êã∂', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'‰ºöÈáà', scores:{ course:null, club:'Âõ≥Êõ∏', vibe:2 } },
          { text:'ÁõÆ„Çí„Åù„Çâ„Åô', scores:{ course:null, club:'ÊñáËä∏', vibe:3 } },
          { text:'Ê∞ó„Å•„ÅÑ„Å¶„Å™„ÅÑ„Åì„Å®„Å´„Åô„Çã', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:4 } }
        ]
      },
      {
        q: 'ÊîæË™≤Âæå„Å´ÂØÑ„Çã„Å®„Åó„Åü„ÇâÔºü',
        choices: [
          { text:'„Ç≤„Éº„Çª„É≥', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:5 } },
          { text:'Êú¨Â±ã', scores:{ course:null, club:'ÊñáËä∏', vibe:2 } },
          { text:'„Ç´„Éï„Çß„ÇÑ„Éï„Ç°„Çπ„Éà„Éï„Éº„Éâ', scores:{ course:'Ëã±Ë™û„Ç≥„Éº„Çπ', club:null, vibe:3 } },
          { text:'„Ç≥„É≥„Éì„Éã„Åß„Åä„ÇÑ„Å§Ë£úÁµ¶', scores:{ course:null, club:'„Éê„Çπ„Ç±„ÉÉ„Éà„Éú„Éº„É´ÈÉ®', vibe:4 } }
        ]
      },
      {
        q: 'ÊéÉÈô§„ÅÆÊôÇÈñì„ÄÅ„Å©„ÅÜ„Åó„Å¶„ÇãÔºü',
        choices: [
          { text:'ÁúüÈù¢ÁõÆ„Å´„ÇÑ„Çã', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'„Åä„Åó„ÇÉ„Åπ„Çä„Çø„Ç§„É†', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:4 } },
          { text:'ÊåáÁ§∫ÂΩπ„Å´„Å™„Çã', scores:{ course:null, club:'Èô∏‰∏äÈÉ®', vibe:2 } },
          { text:'Ê∞ó„Å•„ÅÑ„Åü„ÇâÁµÇ„Çè„Å£„Å¶„Çã', scores:{ course:null, club:'ÁæéË°ì', vibe:5 } }
        ]
      },
      {
        q: 'ÊîæË™≤Âæå„ÄÅË™∞„Å®„ÅÑ„ÇãÔºü',
        choices: [
          { text:'‰∏Ä‰∫∫„Åß„ÅÆ„Çì„Å≥„Çä', scores:{ course:null, club:'Âõ≥Êõ∏', vibe:2 } },
          { text:'‰ª≤ËâØ„Åó„Ç∞„É´„Éº„Éó', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:3 } },
          { text:'ÈÉ®Ê¥ª„ÅÆ„É°„É≥„Éê„Éº', scores:{ course:null, club:'ÂêπÂ•èÊ•ΩÈÉ®', vibe:2 } },
          { text:'„Åù„ÅÆÊó•Ê¨°Á¨¨', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:4 } }
        ]
      },
      {
        q: 'Â≠¶Ê†°Ë°å‰∫ã„Åß‰∏ÄÁï™ÁáÉ„Åà„Çã„ÅÆ„ÅØÔºü',
        choices: [
          { text:'‰ΩìËÇ≤Á•≠', scores:{ course:null, club:'Èô∏‰∏äÈÉ®', vibe:3 } },
          { text:'ÊñáÂåñÁ•≠', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:4 } },
          { text:'ÂêàÂî±„Ç≥„É≥„ÇØ„Éº„É´', scores:{ course:'Èü≥Ê•Ω„Ç≥„Éº„Çπ', club:null, vibe:2 } },
          { text:'‰øÆÂ≠¶ÊóÖË°å', scores:{ course:'Ëã±Ë™û„Ç≥„Éº„Çπ', club:null, vibe:5 } }
        ]
      },
      {
        q: '„ÇØ„É©„Çπ„Åß„ÅÆËá™ÂàÜ„ÅÆÁ´ã„Å°‰ΩçÁΩÆ„ÅØÔºü',
        choices: [
          { text:'„Åæ„Å®„ÇÅÂΩπ', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'„É†„Éº„Éâ„É°„Éº„Ç´„Éº', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:4 } },
          { text:'Á©∫Ê∞ó', scores:{ course:null, club:'Âõ≥Êõ∏', vibe:2 } },
          { text:'Ëá™Áî±‰∫∫', scores:{ course:null, club:'ÁæéË°ì', vibe:5 } }
        ]
      },
      {
        q: '„ÇØ„É©„Çπ„ÅÆÈõ∞Âõ≤Ê∞ó„ÅØÔºü',
        choices: [
          { text:'Êòé„Çã„Åè„Å¶„Å´„Åé„ÇÑ„Åã', scores:{ course:null, club:'„ÉÄ„É≥„ÇπÈÉ®', vibe:4 } },
          { text:'„Åæ„Å®„Åæ„Çä„Åå„ÅÇ„Å£„Å¶Âπ≥Âíå', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:2 } },
          { text:'Èùô„Åã„ÅßÂÄã‰∫∫‰∏ªÁæ©ÁöÑ', scores:{ course:null, club:'Âõ≥Êõ∏', vibe:1 } },
          { text:'„Çè„Å°„ÇÉ„Çè„Å°„ÇÉ„Åó„Å¶„Ç´„Ç™„Çπ', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:5 } }
        ]
      },
      {
        q: 'ÂãâÂº∑„Çπ„Çø„Ç§„É´„ÅØÔºü',
        choices: [
          { text:'„Å®„Å´„Åã„ÅèÈü≥Ë™≠', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'„Éé„Éº„Éà„Çí„Å≤„Åü„Åô„Çâ„Åæ„Å®„ÇÅ„Çã', scores:{ course:null, club:'ÊñáËä∏', vibe:2 } },
          { text:'ÂïèÈ°å„ÇíËß£„Åç„Å™„Åå„ÇâË¶ö„Åà„Çã', scores:{ course:null, club:'Èô∏‰∏äÈÉ®', vibe:3 } },
          { text:'„Ç¢„Éó„É™„ÇÑÂãïÁîª„Çí‰Ωø„ÅÜ', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:4 } }
        ]
      },
      {
        q: '„ÇÇ„ÅóËá™Áî±„Å´ÊéàÊ•≠„ÇíÂ¢ó„ÇÑ„Åõ„Çã„Å™„ÇâÔºü',
        choices: [
          { text:'Ë∂£Âë≥ÂÖ®Èñã„ÅÆÊéàÊ•≠', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:5 } },
          { text:'Â≠¶Ê†°„ÅÆÂ§ñ„ÅßÁ§æ‰ºö‰ΩìÈ®ì„Åô„ÇãÊéàÊ•≠', scores:{ course:'ÁæéË°ì„Ç≥„Éº„Çπ', club:null, vibe:3 } },
          { text:'„Ç≠„É£„É™„Ç¢„ÇÑ‰∫∫ÁîüË®≠Ë®à„ÇíËÄÉ„Åà„ÇãÊéàÊ•≠', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'Êú™Áü•„Å´ÊåëÊà¶„Åô„ÇãÊéàÊ•≠', scores:{ course:null, club:'„Éõ„É©„ÉºÂ∏ÉÊïôÈÉ®', vibe:4 } }
        ]
      },
      {
        q: 'ÂèãÈÅî„Å®Ë©±„Åó„Å¶„Å¶Áõõ„Çä‰∏ä„Åå„Çã„ÉÜ„Éº„Éû„ÅØÔºü',
        choices: [
          { text:'ÊúÄËøë„ÅÆ„Ç¢„Éã„É°„ÇÑ„Ç≤„Éº„É†„ÅÆË©±È°å', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:4 } },
          { text:'ÊÅã„Éê„Éä„ÇÑÊîæË™≤Âæå„ÅÆ‰∫àÂÆö', scores:{ course:null, club:'ÊºîÂäáÈÉ®', vibe:5 } },
          { text:'ÂãâÂº∑„ÇÑÈÄ≤Ë∑Ø„ÅÆ„Åì„Å®„ÇíÁúüÈù¢ÁõÆ„Å´Ë©±„Åô', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'„Å°„Çá„Å£„Å®‰∏çÊÄùË≠∞„Å™‰ΩìÈ®ìË´á„ÇÑÂôÇË©±', scores:{ course:null, club:'„Éõ„É©„ÉºÂ∏ÉÊïôÈÉ®', vibe:5 } }
        ]
      },
      {
        q: 'ÊîæË™≤Âæå„ÅÆÂõ≥Êõ∏ÂÆ§„ÄÅ„ÅÇ„Å™„Åü„ÅåÂêë„Åã„ÅÜÊ£ö„ÅØÔºü',
        choices: [
          { text:'„Éï„Ç°„É≥„Çø„Ç∏„Éº„ÇÑ„É©„Éé„ÉôÁ≥ª„ÅÆÂ∞èË™¨Ê£ö', scores:{ course:null, club:'ÊñáËä∏', vibe:3 } },
          { text:'Ê≠¥Âè≤„ÇÑ‰ºùË®ò„ÅÆË≥áÊñôÊ£ö', scores:{ course:'ÁâπÈÄ≤„Ç≥„Éº„Çπ', club:null, vibe:1 } },
          { text:'ÂøÉÁêÜÂ≠¶„ÉªÂì≤Â≠¶„Éª„Ç™„Ç´„É´„ÉàÁ≥ª„ÅÆÊ£ö', scores:{ course:null, club:'„Éõ„É©„ÉºÂ∏ÉÊïôÈÉ®', vibe:4 } },
          { text:'ÈõëË™å„ÇÑÊº´Áîª„ÅåÁΩÆ„ÅÑ„Å¶„ÅÇ„Çã‰ºëÊÜ©„Çπ„Éö„Éº„Çπ', scores:{ course:null, club:'ËªΩÈü≥ÈÉ®', vibe:5 } }
        ]
      }
    ];

    // Fisher-Yates „Ç∑„É£„ÉÉ„Éï„É´
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    // Ë≥™Âïè„Çí„Ç∑„É£„ÉÉ„Éï„É´„Åó„Å¶10Âïè„ÇíÈÅ∏Êäû
    shuffle(questionPool);
    const questions = questionPool.slice(0, 10);

    // „Çπ„Ç≥„Ç¢Á¥ØÁ©çÁî®„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà
    let tally = {
      course: { 'ÁâπÈÄ≤„Ç≥„Éº„Çπ': 0, 'Ëã±Ë™û„Ç≥„Éº„Çπ': 0, 'Èü≥Ê•Ω„Ç≥„Éº„Çπ': 0, 'ÁæéË°ì„Ç≥„Éº„Çπ': 0 },
      club: {},
      vibe: 0
    };

    let currentQuestionIndex = 0;
    
    // ÂõûÁ≠îÂ±•Ê≠¥„Å®Áä∂ÊÖãÁÆ°ÁêÜ
    let answerHistory = []; // ÂêÑË≥™Âïè„ÅÆÂõûÁ≠îÂ±•Ê≠¥
    let tallyHistory = []; // ÂêÑË≥™ÂïèÊôÇÁÇπ„Åß„ÅÆ„Çπ„Ç≥„Ç¢Â±•Ê≠¥

    // „É©„É≥„ÉÄ„É†„Éú„Éº„Éä„Çπ‰øÇÊï∞
    function getBonus() {
      return 0.8 + Math.random() * 0.4;
    }

    // ÂõûÁ≠îÂá¶ÁêÜ
    function answer(scores) {
      const bonus = getBonus();
      
      if (scores.course) {
        tally.course[scores.course] += bonus;
      }
      if (scores.club) {
        tally.club[scores.club] = (tally.club[scores.club] || 0) + bonus;
      }
      tally.vibe += scores.vibe * bonus;
    }

    // ÁµêÊûúË®àÁÆó
    function calcResult() {
      const courseName = Object.entries(tally.course).sort((a, b) => b[1] - a[1])[0][0];
      
      // Â≠¶Áßë„Å®„Ç≥„Éº„Çπ„ÇíÂàÜÈõ¢
      let department, course, displayCourse;
      switch(courseName) {
        case 'ÁâπÈÄ≤„Ç≥„Éº„Çπ':
          department = 'ÊôÆÈÄöÁßë';
          course = 'ÁâπÈÄ≤';
          displayCourse = 'ÊôÆÈÄöÁßëÔºàÁâπÈÄ≤„Ç≥„Éº„ÇπÔºâ';
          break;
        case 'Ëã±Ë™û„Ç≥„Éº„Çπ':
          department = 'ÊôÆÈÄöÁßë';
          course = 'Ëã±Ë™û';
          displayCourse = 'ÊôÆÈÄöÁßëÔºàËã±Ë™û„Ç≥„Éº„ÇπÔºâ';
          break;
        case 'Èü≥Ê•Ω„Ç≥„Éº„Çπ':
          department = 'Ëä∏Ë°ìÁßë';
          course = 'Èü≥Ê•Ω';
          displayCourse = 'Ëä∏Ë°ìÁßëÔºàÈü≥Ê•Ω„Ç≥„Éº„ÇπÔºâ';
          break;
        case 'ÁæéË°ì„Ç≥„Éº„Çπ':
          department = 'Ëä∏Ë°ìÁßë';
          course = 'ÁæéË°ì';
          displayCourse = 'Ëä∏Ë°ìÁßëÔºàÁæéË°ì„Ç≥„Éº„ÇπÔºâ';
          break;
        default:
          department = courseName;
          course = courseName;
          displayCourse = courseName;
      }
      
      const club = Object.entries(tally.club).length
        ? Object.entries(tally.club).sort((a, b) => b[1] - a[1])[0][0]
        : 'Â∏∞ÂÆÖ';
      
      return { department, course, displayCourse, club };
    }

    // „Éó„É¨„Éì„É•„Éº„É°„ÉÉ„Çª„Éº„Ç∏„ÉÜ„É≥„Éó„É¨„Éº„ÉàÔºà„Ç∑„É≥„Éó„É´„ÅßËá™ÁÑ∂„Å™Ë°®Áèæ„Éª12Á®ÆÔºâ
    const previewTemplates = [
      "üìù ÁúüÈù¢ÁõÆ„Å™Âèñ„ÇäÁµÑ„Åø„Åß„ÄÅ${club}„Åß„ÅÆÊ¥ªÂãï„ÅåÂÖâ„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
      "üé§ ${club}„Åß„ÅÆÊ¥ªË∫ç„ÅåË©±È°å„Å´ÔºÅÊ≥®ÁõÆ„ÅÆÂ≠òÂú®„Åß„Åô„ÄÇ",
      "üëü Ê†°ÂÜÖ„Åß„ÅØ${club}„ÅÆ„Ç®„Éº„Çπ„Å®„Åó„Å¶ÊúüÂæÖ„ÇÇÂ§ß„Åç„ÅÑ„Å®„Åã„ÄÇ",
      "üìö Â≠¶Ê•≠„Å®${club}„Åß„ÅÆÁµåÈ®ì„ÅåË¶ã‰∫ã„Å´„Éû„ÉÉ„ÉÅ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
      "üéß ${club}„ÅßÊä´Èú≤„Åó„Åü„Éë„Éï„Ç©„Éº„Éû„É≥„Çπ„ÅåÂç∞Ë±°ÁöÑ„Åß„Åó„Åü„ÄÇ",
      "üé® ${club}„ÅÆÊ¥ªÂãï„Å´Êâì„Å°Ëæº„ÇÄÂßø„ÅØ„ÄÅ„Åø„Çì„Å™„Åã„Çâ‰∏ÄÁõÆÁΩÆ„Åã„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
      "üåü ${club}„ÅÆÊúüÂæÖ„ÅÆ„É´„Éº„Ç≠„Éº„Å®„Åó„Å¶Ë©±È°å„Å´„Å™„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
      "üì∏ ${club}„Åß„ÅÆ„ÉØ„É≥„Ç∑„Éß„ÉÉ„Éà„ÄÅÁ¥†Êïµ„Å™Èõ∞Âõ≤Ê∞ó„Åå„Å´„Åò„ÅøÂá∫„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
      "üìñ ÂãâÂ≠¶„Å∏„ÅÆÊÑèË≠ò„Å®${club}„Åß„ÅÆË°åÂãïÂäõ„ÅåÁµ∂Â¶ô„Å™„Éê„É©„É≥„ÇπÔºÅ",
      "üé≠ ${club}„Åß„ÅØÁã¨Ëá™„ÅÆË¶ñÁÇπ„ÅßË°®ÁèæÂäõ„ÇíÁô∫ÊèÆ„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ",
      "üí¨ ${club}„Åß„ÅÆÊ¥ªÂãï„Å´„ÇÇÊúüÂæÖÂ§ßÔºÅ‰∫∫Ê∞óËÄÖ„Åß„Åô„ÄÇ",
      "üß© ${club}„Åß„ÅÆÂÄãÊÄßÊ¥æ„Å®„Åó„Å¶Áü•„Çâ„Çå„Å¶„ÅÑ„Åæ„Åô„ÄÇ„Å≤„Çâ„ÇÅ„Åç„ÅåÈ≠ÖÂäõÁöÑ„Åß„Åô„ÄÇ"
    ];

    // „Éó„É¨„Éì„É•„Éº„É°„ÉÉ„Çª„Éº„Ç∏ÁîüÊàêÈñ¢Êï∞
    function makeMsg(result) {
      const template = previewTemplates[Math.floor(Math.random() * previewTemplates.length)];
      // ÈÉ®Ê¥ªÂãïÂêç„Å´„ÄåÈÉ®„Äç„Çí‰ªò„Åë„Çã
      const clubWithBu = result.club.endsWith('ÈÉ®') ? result.club : result.club + 'ÈÉ®';
      return template
        .replace(/\$\{course\}/g, result.course)
        .replace(/\$\{club\}/g, clubWithBu);
    }

    // ÂÄãÊÄß„Ç®„Éî„ÇΩ„Éº„Éâ„ÉÜ„É≥„Éó„É¨„Éº„ÉàÔºà50Á®ÆÔºâ
    const episodeTemplates = [
      "Áµ¶È£ü„ÅÆ„Çº„É™„Éº„ÇíÊØéÊó•ÂèãÈÅî„Å®„Ç∏„É£„É≥„Ç±„É≥„ÅßÂ•™„ÅÑÂêà„Å£„Å¶„ÅÑ„Çã„ÄÇ",
      "ÊïôÂÆ§„ÅÆÈöÖ„Å£„Åì„Åß„Åì„Å£„Åù„ÇäÊäò„ÇäÁ¥ô„ÇíÈáèÁî£„Åó„Å¶„ÅÑ„Çã„ÄÇ",
      "ÊéÉÈô§„ÅÆÊôÇÈñì„ÄÅ„Åª„ÅÜ„Åç„Åß„Ç®„Ç¢„ÇÆ„Çø„Éº„ÇíÂßã„ÇÅ„Åå„Å°„ÄÇ",
      "‰ΩìËÇ≤„ÅÆÊ∫ñÂÇôÈÅãÂãï„Å´ÂÖ®Âäõ„Åô„Åé„Å¶ÊØéÂõûÁ¨ë„ÅÑ„ÅåËµ∑„Åç„Çã„ÄÇ",
      "ÂÆøÈ°å„ÇíÂøò„Çå„Å¶„ÇÇ„ÄåÈ¢®„ÅÆ„Åõ„ÅÑ„Äç„Å®Ë®Ä„ÅÑË®≥„Åó„Å¶‰πó„ÇäÂàá„ÇãÂ§©Êâç„ÄÇ",
      "Êúù„ÅÆÊå®Êã∂„Åå„Åß„Åã„Åô„Åé„Å¶Èö£„ÅÆÊïôÂÆ§„Åæ„ÅßËÅû„Åì„Åà„Çã„ÄÇ",
      "ÈªíÊùø„Å´Êõ∏„ÅÑ„Åü„Ç§„É©„Çπ„Éà„ÇíÂãùÊâã„Å´\"ÈÄ£ËºâÂåñ\"„Åó„Å¶„ÅÑ„Çã„ÄÇ",
      "„Éé„Éº„Éà„ÅÆÁ´Ø„Å´ÊØéÂõûÂ§â„Å™„Ç≠„É£„É©„ÅåÁôªÂ†¥„Åó„Å¶„ÅÑ„Çã„ÄÇ",
      "Âõ≥Êõ∏ÂÆ§„ÅÆÈöÖ„Åß„Å™„Åú„ÅãÁ¥ôËäùÂ±Ö„Çí„Åó„Å¶„ÅÑ„Åü„Åì„Å®„Åå„ÅÇ„Çã„ÄÇ",
      "ÈâÑÊ£í„ÇíË¶ã„Çã„Å®„Å§„ÅÑÈÄÜ‰∏ä„Åå„Çä„Åó„Åü„Åè„Å™„ÇãË°ùÂãï„Å´ÈßÜ„Çâ„Çå„Çã„ÄÇ",
      "ÁæéË°ìÂÆ§„ÅßÁµµ„ÅÆÂÖ∑„ÅÆ„Éï„Çø„ÇíÈñã„Åë„Çã‰øÇ„ÇíÂãùÊâã„Å´„Åó„Å¶„ÅÑ„Çã„ÄÇ",
      "ÈÅÖÂàª„ÇÆ„É™„ÇÆ„É™„Å™„ÅÆ„Å´Áå´„Å®ÈÅä„Çì„Åß„Åã„ÇâÁôªÊ†°„Åó„Å¶„Åè„Çã„ÄÇ",
      "Êú∫„ÅÆ‰∏≠„Å´Ë¨é„ÅÆÁ¥ôÈ£õË°åÊ©ü„Ç≥„É¨„ÇØ„Ç∑„Éß„É≥„ÅåÁú†„Å£„Å¶„ÅÑ„Çã„ÄÇ",
      "ÊéàÊ•≠‰∏≠„Å´Á™ÅÁÑ∂„Äå‰ªä„ÇÅ„Å£„Å°„ÇÉÈñÉ„ÅÑ„ÅüÔºÅ„Äç„Å®Ë®Ä„ÅÑÂá∫„Åô„ÄÇ",
      "ÈÄ£Áµ°Â∏≥„ÅÆ„É°„É¢Ê¨Ñ„Å´ÂêçË®Ä„ÇíÊó•Êõø„Çè„Çä„ÅßÊõ∏„ÅÑ„Å¶„ÅÑ„Çã„ÄÇ",
      "Ê∂à„Åó„Ç¥„É†„ÅÆ„Ç´„Çπ„Çí‰Ωø„Å£„Å¶Â∞è„Åï„Å™Ëä∏Ë°ì‰ΩúÂìÅ„Çí‰Ωú„Çã„ÄÇ",
      "Èõ®„ÅÆÊó•„ÅØÂÇò„ÇíÊåØ„ÇäÂõû„Åó„Å¶È≠îÊ≥ï‰Ωø„ÅÑ„Å´„Å™„Çä„Åå„Å°„ÄÇ",
      "ÁõÆ„ÅåÂêà„Å£„Åü„Å†„Åë„Åß„Äå„ÉÜ„É¨„Éë„Ç∑„ÉºÈÄÅ„Å£„Åü„Äç„Å®Ë®Ä„Å£„Å¶„Åè„Çã„ÄÇ",
      "Êú∫„ÅÆËßí„ÅßÂÆöË¶è„ÇíÂºæ„ÅÑ„Å¶Âç≥Ëàà„É©„Ç§„Éñ„ÇíÂßã„ÇÅ„Çã„ÄÇ",
      "‰øùÂÅ•ÂÆ§„Å´Ë°å„ÅèÂõûÊï∞„ÅåÂ§ö„Åô„Åé„Å¶\"Ê∫ñ„É¨„ÇÆ„É•„É©„Éº\"Êâ±„ÅÑ„ÄÇ",
      "„ÅÑ„Å§„ÇÇÊñáÊàøÂÖ∑„ÅåÂèØÊÑõ„Åè„Å¶„ÇØ„É©„Çπ„É°„Ç§„Éà„Å´Ë≤∏„ÅóÂá∫„Åó‰∏≠„ÄÇ",
      "Êòº‰ºë„Åø„Å´ÊïôÂçì„ÅÆÂæå„Çç„Åß„Çπ„Éà„É¨„ÉÉ„ÉÅ„Åó„Åå„Å°„ÄÇ",
      "„Ç´„Éê„É≥„Å´Â∏∏„Å´„Åä„ÇÑ„Å§„ÇíÈö†„ÅóÊåÅ„Å£„Å¶„ÅÑ„Å¶‰∫∫Ê∞óËÄÖ„ÄÇ",
      "ÊúùÁ§º„Åß„Éú„Éº„ÉÉ„Å®„Åó„Å¶„Çã„Çà„ÅÜ„ÅßÊ°àÂ§ñË©±„ÇíÂÖ®ÈÉ®Ë¶ö„Åà„Å¶„ÅÑ„Çã„ÄÇ",
      "„Å≤„Å®„Åì„Å®Êó•Ë®ò„ÅåÊØéÂõû„Éù„Ç®„É†È¢®„ÅßÂÖàÁîü„Å´„Éê„É¨„Å¶„ÅÑ„Çã„ÄÇ",
      "‰ºë„ÅøÊôÇÈñì„Å´„Å™„Çã„Å®ÊïôÂÆ§„ÅÆÂ£Å„Åß\"Â£Å„Éâ„É≥\"„ÇíÂßã„ÇÅ„Çã„ÄÇ",
      "ÊéàÊ•≠„ÅÆÁµÇ„Çè„Çä„Å´ÂÖàÁîü„ÅÆ„Éû„Éç„Çí„Åó„Å¶Á¨ë„Çè„Åõ„Å´„Åè„Çã„ÄÇ",
      "‰∏äÂ±•„Åç„Çí„Åô„ÅêËÑ±„ÅÑ„Åß\"Â∫ä„Çπ„É©„Ç§„Éâ\"„Åó„Çà„ÅÜ„Å®„Åô„Çã„ÄÇ",
      "Ê†°ÂÜÖÊîæÈÄÅ„ÅÆ„Ç∏„É≥„Ç∞„É´„ÇíÂè£Á¨õ„Åß„Ç≥„Éî„Éº„Åó„Åå„Å°„ÄÇ",
      "„Åü„Åæ„Å´Á≠ÜÁÆ±„Åã„Çâ„Çπ„É©„Ç§„É†„ÅåÂá∫„Å¶„Åè„ÇãË¨é„ÅÆÂ≠òÂú®„ÄÇ",
      "Ë≥ºË≤∑„ÅÆ„Éë„É≥„ÅÆÁ®ÆÈ°û„Å´Ë©≥„Åó„Åô„Åé„Å¶\"„Éë„É≥ÂçöÂ£´\"„Å®Âëº„Å∞„Çå„Çã„ÄÇ",
      "ÈõªÂçì„ÇíÊåÅ„Å°Ê≠©„ÅÑ„Å¶„Çã„ÅÆ„Å´‰Ωø„Å£„Å¶„Çã„Å®„Åì„Çç„ÅØË™∞„ÇÇË¶ã„Å¶„ÅÑ„Å™„ÅÑ„ÄÇ",
      "ÊïôÂÆ§„ÅÆÊ∏©Â∫¶Ë™øÊï¥‰øÇ„ÇíËá™Áß∞„Åó„Å¶„ÅÑ„Çã„ÄÇ",
      "Á≠ÜË®òÁî®ÂÖ∑„Çí\"Ê≠¶Âô®\"„Å®„Åó„Å¶ÂëΩÂêç„Åó„Å¶„ÅÑ„Çã„ÄÇ",
      "‰ΩìËÇ≤Á•≠„ÅÆÂøúÊè¥„Å´ÂÖ®Âäõ„Åô„Åé„Å¶Â£∞„ÅåÊûØ„Çå„Çã„ÅÆ„ÅåÊØéÂπ¥ÊÅí‰æã„ÄÇ",
      "ÊïôÂÆ§„ÅÆÈªíÊùø„ÇíÂãùÊâã„Å´\"‰ªäÊó•„ÅÆ‰∏ÄË®Ä\"„ÅßÂüã„ÇÅ„Åå„Å°„ÄÇ",
      "„ÉÜ„Çπ„ÉàÂâç„Å´„Å™„Çã„Å®Ë™∞„Çà„Çä„ÇÇÊó©„ÅèÊú∫„Å´ÁùÄÂ∏≠„Åó„Å¶„Åù„Çè„Åù„Çè„Åó„Å¶„Çã„ÄÇ",
      "Ëá™‰Ωú„ÅÆË¨é„É´„Éº„É´„ÅßÊØéÊúù\"„Éü„ÉãÊ§úÂÆö\"„ÇíÈñãÂÇ¨„Åó„Å¶„ÅÑ„Çã„ÄÇ",
      "„Ç∑„É£„Éº„Éö„É≥ÂàÜËß£„ÅåÂæóÊÑè„Åß„ÄåÂ∑•Â†¥Èï∑„Äç„Å®Âëº„Å∞„Çå„Å¶„ÅÑ„Çã„ÄÇ",
      "‰∏ãÊ†°ÊôÇ„ÄÅÈù¥ÁÆ±„ÅßÊØéÂõû‰Ωï„ÅãÊé¢„Åó„Å¶„ÅÑ„Çã„Åå‰Ωï„Åã„ÅØ‰∏çÊòé„ÄÇ",
      "‰ºë„ÅøÊôÇÈñì„Å´Ê§ÖÂ≠ê„ÇíÈáç„Å≠„Å¶\"ÁßòÂØÜÂü∫Âú∞\"„Çí‰Ωú„Çä„Åü„Åå„Çã„ÄÇ",
      "„Ç¢„Éä„É≠„Ç∞ÊôÇË®à„ÇíË™≠„ÇÄ„ÅÆ„ÅåÊó©„Åô„Åé„Å¶ÂÖàÁîü„Çà„ÇäÂÖà„Å´Ë®Ä„ÅÜ„ÄÇ",
      "ÊéàÊ•≠‰∏≠„Å´Á©∫‰∏≠„ÅßÊåá„ÇíÂãï„Åã„Åó„Å¶„Çø„Ç§„Éî„É≥„Ç∞„Åó„Å¶„Çã„ÄÇ",
      "ÊïôÁßëÊõ∏„ÅÆÈöÖ„Å´ÊØéÈÄ±ÈÅï„ÅÜ\"„Éû„Çπ„Ç≥„ÉÉ„Éà\"„ÇíÊèè„ÅÑ„Å¶„ÅÑ„Çã„ÄÇ",
      "ÈõÜÂêàÂÜôÁúü„Åß„Å™„Åú„ÅãÊØéÂõû\"„Å©Áúü„Çì‰∏≠\"„Å´ÂÜô„Å£„Å¶„ÅÑ„Çã„ÄÇ",
      "Ê†°Â§ñÂ≠¶Áøí„Åß„ÅØË™∞„Çà„Çä„ÇÇ„Çπ„Ç±„Ç∏„É•„Éº„É´„ÇíÊääÊè°„Åó„Å¶„ÅÑ„Çã„ÄÇ",
      "Ë™≤È°å„Éó„É™„É≥„Éà„ÅÆË£è„Å´„Äå„Å§„Å•„Åç„ÅØWeb„Åß„Äç„Å®Êõ∏„Åè„ÇØ„Çª„ÅÇ„Çä„ÄÇ",
      "ÊåÅ„Å°Áâ©Ê§úÊüª„ÅÆ„Å®„Åç„Å†„ÅëÊÄ•„Å´\"ÂÆåÁíß‰∏ªÁæ©\"„Å´„Å™„Çã„ÄÇ",
      "„ÅäÊòº„ÅÆÊîæÈÄÅ„É™„ÇØ„Ç®„Çπ„Éà„Å´\"Ë¨é„ÅÆ„Çª„É¨„ÇØ„Éà\"„ÇíÂá∫„Åó„Å¶„Åè„Çã„ÄÇ",
      "Ëá™ÂàÜ„ÅÆÂ∏≠„Åò„ÇÉ„Å™„Åè„Å¶„ÇÇËá™ÁÑ∂„Å´Â∫ß„Å£„Å¶ÊéàÊ•≠Âèó„Åë„Å¶„ÅÑ„Çã„ÄÇ"
    ];

    // ÂÄãÊÄß„Ç®„Éî„ÇΩ„Éº„ÉâÁîüÊàêÈñ¢Êï∞
    function makeEpisodeMsg() {
      const randomIndex = Math.floor(Math.random() * episodeTemplates.length);
      return episodeTemplates[randomIndex];
    }

    // Ë≥™ÂïèË°®Á§∫
    function showQuestion(index) {
      if (index >= questions.length) {
        showResult();
        return;
      }

      const question = questions[index];
      const container = document.getElementById('questionContainer');
      
      container.innerHTML = `
        <div class="question-card active fade-in">
          <div class="question-title">Ë≥™Âïè ${index + 1} / ${questions.length}</div>
          <div class="question-text">${question.q}</div>
          <div class="answer-options">
            ${question.choices.map((choice, i) => 
              `<div class="answer-option" onclick="selectAnswer(${i})">${choice.text}</div>`
            ).join('')}
          </div>
          <div class="question-controls">
            ${index > 0 ? `
              <button class="back-btn" onclick="goToPreviousQuestion()">
                <i class="fas fa-arrow-left"></i>
                Ââç„ÅÆË≥™Âïè
              </button>
            ` : '<div></div>'}
            <span class="question-number">${index + 1} / ${questions.length}</span>
          </div>
        </div>
      `;

      // ÈÄ≤Êçó„Éê„ÉºÊõ¥Êñ∞
      const progress = ((index + 1) / questions.length) * 100;
      document.getElementById('progressFill').style.width = `${progress}%`;
    }

    // ÂõûÁ≠îÈÅ∏Êäû
    function selectAnswer(answerIndex) {
      const question = questions[currentQuestionIndex];
      const selectedChoice = question.choices[answerIndex];
      
      // ÁèæÂú®„ÅÆ„Çπ„Ç≥„Ç¢Áä∂ÊÖã„ÇíÂ±•Ê≠¥„Å´‰øùÂ≠òÔºàÂ§âÊõ¥ÂâçÔºâ
      tallyHistory[currentQuestionIndex] = JSON.parse(JSON.stringify(tally));
      
      // ÂõûÁ≠îÂ±•Ê≠¥„Å´‰øùÂ≠ò
      answerHistory[currentQuestionIndex] = {
        questionIndex: currentQuestionIndex,
        answerIndex: answerIndex,
        choice: selectedChoice
      };
      
      // „Ç´„Éº„Éâ„Éï„Çß„Éº„Éâ„Ç¢„Ç¶„Éà„Ç®„Éï„Çß„ÇØ„Éà
      const card = document.querySelector('.question-card.active');
      card.classList.add('fade-out');
      
      // „Çπ„Ç≥„Ç¢Ë®àÁÆó
      answer(selectedChoice.scores);
      
      setTimeout(() => {
        currentQuestionIndex++;
        showQuestion(currentQuestionIndex);
      }, 400);
    }

    // Ââç„ÅÆË≥™Âïè„Å´Êàª„Çã
    function goToPreviousQuestion() {
      if (currentQuestionIndex <= 0) return;
      
      // „Ç§„É≥„Éá„ÉÉ„ÇØ„Çπ„ÇíÊàª„Åô
      currentQuestionIndex--;
      
      // „Çπ„Ç≥„Ç¢„ÇíÂâç„ÅÆÁä∂ÊÖã„Å´Âæ©ÂÖÉ
      if (tallyHistory[currentQuestionIndex]) {
        tally = JSON.parse(JSON.stringify(tallyHistory[currentQuestionIndex]));
      }
      
      // Â±•Ê≠¥„Åã„ÇâË©≤ÂΩì„Ç®„É≥„Éà„É™„ÇíÂâäÈô§
      answerHistory.splice(currentQuestionIndex, 1);
      tallyHistory.splice(currentQuestionIndex, 1);
      
      // Ë≥™Âïè„ÇíË°®Á§∫
      showQuestion(currentQuestionIndex);
    }

    // ÁµêÊûúË°®Á§∫
    function showResult() {
      document.getElementById('questionContainer').style.display = 'none';
      document.getElementById('resultContainer').style.display = 'block';
      
      const result = calcResult();
      
      // ÁµêÊûú„Çí„Éö„Éº„Ç∏„Å´Ë°®Á§∫
      document.getElementById('resultCourse').textContent = result.displayCourse;
      
      // ÈÉ®Ê¥ªÂãïÂêç„Å´„ÄåÈÉ®„Äç„Çí‰ªò„Åë„Å¶Ë°®Á§∫
      const clubDisplayName = result.club.endsWith('ÈÉ®') ? result.club : result.club + 'ÈÉ®';
      document.getElementById('resultClub').textContent = clubDisplayName;
      
      // „Éó„É¨„Éì„É•„Éº„É°„ÉÉ„Çª„Éº„Ç∏
      const previewMessage = makeMsg(result);
      document.getElementById('previewMsg').textContent = previewMessage;
      
      // ÂÄãÊÄß„Ç®„Éî„ÇΩ„Éº„Éâ„É°„ÉÉ„Çª„Éº„Ç∏
      const episodeMessage = makeEpisodeMsg();
      document.getElementById('episodeMsg').textContent = episodeMessage;
      
      // Â≠¶ÁîüË®º‰ΩúÊàê„Éú„Çø„É≥„ÅÆÂá¶ÁêÜ
      document.getElementById('toGeneratorBtn').onclick = () => {
        // ÈÉ®Ê¥ªÂãï„Çígenerator.html„ÅÆ‰ªïÊßò„Å´Âêà„Çè„Åõ„Å¶„Éû„ÉÉ„Éî„É≥„Ç∞
        const clubMapping = {
          'Èô∏‰∏äÈÉ®': 'Èô∏‰∏äÈÉ®',
          '„ÉÜ„Éã„ÇπÈÉ®': '„ÉÜ„Éã„ÇπÈÉ®', 
          '„Éê„Çπ„Ç±„ÉÉ„Éà„Éú„Éº„É´ÈÉ®': '„Éê„Çπ„Ç±„ÉÉ„Éà„Éú„Éº„É´ÈÉ®',
          '„Éê„É¨„Éº„Éú„Éº„É´ÈÉ®': '„Éê„É¨„Éº„Éú„Éº„É´ÈÉ®',
          '„Éê„Éâ„Éü„É≥„Éà„É≥ÈÉ®': '„Éê„Éâ„Éü„É≥„Éà„É≥ÈÉ®',
          'Ê∞¥Ê≥≥ÈÉ®': 'Ê∞¥Ê≥≥ÈÉ®',
          '„ÉÄ„É≥„ÇπÈÉ®': '„ÉÄ„É≥„ÇπÈÉ®',
          'Â£∞Ê•ΩÈÉ®': 'Â£∞Ê•ΩÈÉ®',
          'ÂêπÂ•èÊ•ΩÈÉ®': 'ÂêπÂ•èÊ•ΩÈÉ®',
          'ÁµµÁîªÈÉ®': 'ÁµµÁîªÈÉ®',
          'ÂΩ´ÂàªÈÉ®': 'ÂΩ´ÂàªÈÉ®',
          'ÊîæÈÄÅÈÉ®': 'ÊîæÈÄÅÈÉ®',
          'Ëã±Ë™ûÁ†îÁ©∂ÈÉ®': 'Ëã±Ë™ûÁ†îÁ©∂ÈÉ®',
          'ÊºîÂäáÈÉ®': 'ÊºîÂäáÈÉ®',
          'Ëå∂ÈÅìÈÉ®': 'Ëå∂ÈÅìÈÉ®',
          'ËèØÈÅìÈÉ®': 'ËèØÈÅìÈÉ®',
          '„Éõ„É©„ÉºÂ∏ÉÊïôÈÉ®': '„Éõ„É©„ÉºÂ∏ÉÊïôÈÉ®',
          'ËªΩÈü≥ÈÉ®': 'ËªΩÈü≥ÈÉ®',
          'Â∏∞ÂÆÖ': 'ÊñáËä∏',
          '„Å™„Åó': 'ÊñáËä∏'
        };
        
        const mappedClub = clubMapping[result.club] || 'ÊñáËä∏';
        
        const url = new URL('generator.html', window.location.href);
        url.searchParams.set('department', result.department);
        url.searchParams.set('course', result.course);
        url.searchParams.set('club', mappedClub);
        url.searchParams.set('previewMessage', previewMessage);
        url.searchParams.set('episodeMessage', episodeMessage);
        window.location.href = url.toString();
      };

      // Ë®∫Êñ≠„Çí„ÇÑ„ÇäÁõ¥„Åô„Éú„Çø„É≥„ÅÆÂá¶ÁêÜ
      document.getElementById('restartBtn').onclick = () => {
        // „Éö„Éº„Ç∏„Çí„É™„É≠„Éº„Éâ„Åó„Å¶ÊúÄÂàù„Åã„ÇâÈñãÂßã
        window.location.reload();
      };
    }

    // ÂàùÊúüÂåñ
    document.addEventListener('DOMContentLoaded', function() {
      // URL„Éë„É©„É°„Éº„Çø„ÇíÁ¢∫Ë™ç
      const params = new URLSearchParams(location.search);
      const showResult = params.get('showResult');
      const department = params.get('department');
      const course = params.get('course');
      const club = params.get('club');
      const savedPreviewMessage = params.get('previewMessage');
      const savedEpisodeMessage = params.get('episodeMessage');
      
      // Ë®∫Êñ≠ÁµêÊûú„ÇíÂÜçË°®Á§∫„Åô„ÇãÂ†¥Âêà
      if (showResult === 'true' && department && course && club) {
        // ÁµêÊûú„Éá„Éº„Çø„ÇíÂæ©ÂÖÉ
        const result = {
          department: department,
          course: course,
          displayCourse: department === 'ÊôÆÈÄöÁßë' 
            ? `ÊôÆÈÄöÁßëÔºà${course}„Ç≥„Éº„ÇπÔºâ` 
            : `Ëä∏Ë°ìÁßëÔºà${course}„Ç≥„Éº„ÇπÔºâ`,
          club: club
        };
        
        // ÁµêÊûúË°®Á§∫
        document.getElementById('questionContainer').style.display = 'none';
        document.getElementById('resultContainer').style.display = 'block';
        
        // ÁµêÊûú„Çí„Éö„Éº„Ç∏„Å´Ë°®Á§∫
        document.getElementById('resultCourse').textContent = result.displayCourse;
        
        // ÈÉ®Ê¥ªÂãïÂêç„Å´„ÄåÈÉ®„Äç„Çí‰ªò„Åë„Å¶Ë°®Á§∫
        const clubDisplayName = result.club.endsWith('ÈÉ®') ? result.club : result.club + 'ÈÉ®';
        document.getElementById('resultClub').textContent = clubDisplayName;
        
        // „Éó„É¨„Éì„É•„Éº„É°„ÉÉ„Çª„Éº„Ç∏Ôºà‰øùÂ≠ò„Åï„Çå„Å¶„ÅÑ„Çå„Å∞„Åù„Çå„Çí‰ΩøÁî®„ÄÅ„Å™„Åë„Çå„Å∞Êñ∞Ë¶èÁîüÊàêÔºâ
        const previewMessage = savedPreviewMessage || makeMsg(result);
        document.getElementById('previewMsg').textContent = previewMessage;
        
        // ÂÄãÊÄß„Ç®„Éî„ÇΩ„Éº„Éâ„É°„ÉÉ„Çª„Éº„Ç∏Ôºà‰øùÂ≠ò„Åï„Çå„Å¶„ÅÑ„Çå„Å∞„Åù„Çå„Çí‰ΩøÁî®„ÄÅ„Å™„Åë„Çå„Å∞Êñ∞Ë¶èÁîüÊàêÔºâ
        const episodeMessage = savedEpisodeMessage || makeEpisodeMsg();
        document.getElementById('episodeMsg').textContent = episodeMessage;
        
        // Â≠¶ÁîüË®º‰ΩúÊàê„Éú„Çø„É≥„ÅÆÂá¶ÁêÜ
        document.getElementById('toGeneratorBtn').onclick = () => {
          const url = new URL('generator.html', window.location.href);
          url.searchParams.set('department', result.department);
          url.searchParams.set('course', result.course);
          url.searchParams.set('club', result.club);
          url.searchParams.set('previewMessage', previewMessage);
          url.searchParams.set('episodeMessage', episodeMessage);
          window.location.href = url.toString();
        };

        // Ë®∫Êñ≠„Çí„ÇÑ„ÇäÁõ¥„Åô„Éú„Çø„É≥„ÅÆÂá¶ÁêÜ
        document.getElementById('restartBtn').onclick = () => {
          // URL„Éë„É©„É°„Éº„Çø„ÇíÂâäÈô§„Åó„Å¶„É™„É≠„Éº„Éâ
          window.location.href = 'index.html';
        };
      } else {
        // ÈÄöÂ∏∏„ÅÆË®∫Êñ≠ÈñãÂßã
        showQuestion(0);
      }
    });
  </script>
</body>
</html> 